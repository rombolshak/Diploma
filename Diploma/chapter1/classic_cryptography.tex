
\section{Классическая криптография}
Задача передачи секретной информации известна человечеству с самых ранних времён. Из основных типов сведений, для которых может быть важна их
секретная передача, можно выделить следующие:
\begin{itemize}
  \item важная государственная информация,
  \item информация, содержащая военные секреты,
  \item коммерческие данные,
  \item личная конфиденциальная информация.
\end{itemize}

Исход большого количества военных кампаний и финансовый успех многих корпораций всегда был напрямую связан в том числе с умением передавать
информацию без её утечки к третьим лицам, что говорит о существенной ценности развития технологий секретной передачи данных.

\subsection{Симметричные и асимметричные криптосистемы}
Традиционно для шифрования информации используются два подхода: симметричные криптосистемы и асимметричные.
В симметричных методах шифрования применяется один и тот же ключ как для шифрования, так и для расшифрования данных. Обе стороны коммуникации должны знать этот ключ и хранить его в секрете.
При асимметричном шифровании используется два ключа: открытый и закрытый. Открытый ключ передаётся по незащищённому каналу и используется для проверки электронной подписи и шифрования сообщения.
Закрытый ключ используется для расшифрования сообщений и генерации электронной подписи. 

Асимметричные криптосистемы имеют ряд преимуществ перед симметричными: 
\begin{itemize}
  \item не нужно предварительно передавать секретный ключ по надёжному каналу,
  \item этот секретный ключ известен только одной стороне, 
  \item пару ключей можно долгое время не менять.
\end{itemize}

Однако есть и серьезные недостатки, которые не позволяют полностью перейти на использование асимметричных систем: 
\begin{itemize}
  \item в алгоритм сложно внести изменения, 
  \item ключи имеют большую длину,
  \item по сравнению с симметричными криптосистемами процесс шифрования и расшифрования медленнее на порядки, 
  \item требуются значительно большие вычислительные мощности для функционирования асиметричной криптосистемы. 
\end{itemize}

\subsection{Стойкость симметричного шифрования}
Итак, главное свойство симметричных шифров~--- в них используется один и тот же ключ $k$ для шифрования и расшифрования сообщения.
Это можно обозначить как $$ C = E_k(m),\ m = D_k(C), $$
\begin{itemize}
  \item[где] $E$~--- шифрующая функция,
  \item $D$~--- расшифровывающая функция,
  \item $m$~--- исходное сообщение,
  \item $C$~--- шифротекст.
\end{itemize}

Приведем теоретическое обоснование стойкости одного из наиболее важного метода шифрования~--- одноразового блокнота \cite{vernam_cryptosystem}.
Введем обозначения: \\
$ \mathbb{M}$~--- множество всевозможных открытых текстов $M$, \\
$ \mathbb{C}$~--- множество шифротекстов $C$, \\
$ \mathbb{K}$~--- множество ключей $K$.

На каждом из указанных множеств введена вероятность выбора соответствующего элемента.
Для возможности однозначного расшифрования сообщения, требуется $|\mathbb{C}| \ge |\mathbb{M}|.$
Кроме того, целесообразно полагать, что выбор ключа не должен зависеть от передаваемого сообщения: $p(M = m, K = k) = p(M = m) p(K = k).$

Пытаясь вскрыть шифр, Ева (этим именем в дальнейшем будем называть злоумышленника, перехватчика, подслушивателя) имеет задачу нахождения исходного сообщения $m$ по его шифротексту $c$. Вероятность решить эту задачу равна
$$ p(M = m | C = c) = \frac{p(M = m) p(C = c|M = m)}{p(C = c)}. $$
Цель Алисы и Боба (этими именами будем называть легитимных пользователей протокола) состоит в том, чтобы шифротекст давал как можно меньше информации об исходном сообщении.

\begin{definition}
  Криптосистема называется абсолютно стойкой, если для всех открытых текстов $m$ и всех шифротекстов $c$ выполняется
$$ p(C = c|M = m) = p(M = m). $$
\end{definition}
\begin{theorem}
Если пары сообщения из $M$ и соответствующего ему шифротекста из $C$~-- статистически независимые случайные величины, 
то такая криптосистема обладает \textit{совершенной криптостойкостью}.   
\end{theorem}

Пусть сообщения $M$ и ключи $K$ являются независимыми случайными величинами. Это значит, что совместное распределение $P_{mk}(M, K)$ равно произведению отдельных распределений:
$$P_{mk}(M, K) = P_m(M) \cdot P_k(K).$$

Пусть $C = E_K(M)$~--- шифрованный текст, $M = D_K(C)$~--- расшифрованный текст. Можно найти $P_c(C)$, $P_{mck}(M, C, K).$

Оценим энтропию открытого текста $M$ с учетом статистической независимости $M$ и $C$:
$$H(M) = H(M|C) \leq H(MK|C) = H(K|C) + H(M|CK) = H(K|C) \leq H(K).$$

Так как энтропия открытого текста при заданном шифротексте и известном ключе равна нулю, то $H(M|CK) = 0$. В результате получаем
$$ H(M) \leq H(K). $$

С другой стороны, энтропия открытого текста $H(M)$ характеризует минимальную длину последовательности для описания случайной величины 
$M$ (открытого сообщения), а $H(K)$ характеризует минимальную длину последовательности для описания ключа. Получилось, что совершенная криптостойкость возможна 
только тогда, когда длина ключа не меньше, чем длина шифруемого сообщения, то есть
$$ H(M) \leq H(K). $$

Таким образом, приходим к теореме Шеннона:
\begin{theorem}
  Симметричная криптосистема, заданная набором $$ (\mathbb{M}, \mathbb{C}, \mathbb{K}, E_k(\cdot), D_k(\cdot)), $$
  где $|\mathbb{M}| = |\mathbb{C}| = |\mathbb{K}|$, является абсолютно стойкой тогда и только тогда, когда выполнены условия:
  \begin{enumerate}
    \item вероятности использования всех ключей равны: $p(K = k) = 1 / |\mathbb{K}|, \forall k \in \mathbb{K}$,
    \item для каждой пары сообщения $m \in \mathbb{M}$ и шифротекста $c \in \mathbb{C}$ существует только один ключ $k \in \mathbb{K}$ такой, что $E_k(m) = c$.
  \end{enumerate}
\end{theorem}


\subsection{Криптосистема Вернама}
Ниже приведено описание принципа работы криптосистемы, придуманной Гилбертом Вернамом в 1917 году.

Пусть сообщение представлено двоичной последовательностью длины $N$:
$$ m = (m_1, m_2, \cdots, m_N). $$

Распределение вероятностей сообщений $P_m(m)$ может быть любым. Ключ также представлен двоичной последовательностью $k =
(k_1, k_2, \cdots, k_N )$ той же длины, но с равномерным распределением $P_k(k) = \frac{1}{2^N}$
для всех ключей.

Шифрование в криптосистеме Вернама осуществляется путём покомпонентного суммирования по модулю 2 последовательностей открытого текста и ключа:
$$C = M \oplus K = (m_1 \oplus k_1, m_2 \oplus k_2, \cdots, m_N \oplus k_N ).$$

Легальный пользователь знает ключ и осуществляет расшифрование:
$M = C \oplus K = (m_1 \oplus k_1, m_2 \oplus k_2, \cdots, m_N \oplus k_N ).$

После выполнения этих операций ключ перестаёт использоваться, что объясняет другое название шифра Вернама~--- \textit{одноразовый блокнот}. 

\paragraph*{}
Основная задача, к которой приводит использование симметричных криптосистем: как секретно передать секретный ключ?
Если в нашем распоряжении имеется надёжный канал, то отпадает и необходимость использовать какое бы то ни было шифрование.
В противном случае, в предположении о неограниченных вычислительных и иных возможностях злоумышленника (единственное условие: должны соблюдаться законы природы),
задача распределения ключей оказывается неразрешимой в классической физике. Однако, с помощью квантовой физики можно предъявить такой протокол распределения ключей, 
что какими бы возможностями не обладал злоумышленник (с учетом того же условия), легитимные пользователи либо получат общий секретный ключ, который не будет известен злоумышленнику,
либо любое вторжение злоумышленника в канал связи будет приводить к детектированию подслушивания.