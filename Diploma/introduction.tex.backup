%\chapter{Введение}				% Заголовок
%\addcontentsline{toc}{section}{Введение}	% Добавляем его в оглавление

\section{Классическая криптография}
Задача передачи секретной информации известна человечеству с самых ранних времён. Из основных типов сведений, для которых может быть важна их
секретная передача, можно выделить следующие:
\begin{itemize}
  \item важная государственная информация,
  \item информация, содержащая военные секреты,
  \item коммерческие данные,
  \item личная конфиденциальная информация.
\end{itemize}

Исход большого количества военных кампаний и финансовый успех многих корпораций всегда был напрямую связан в том числе с умением передавать
информацию без её утечки к третьим лицам, что говорит о существенной ценности развития технологий секретной передачи данных.

\subsection{Симметричные и асимметричные криптосистемы}
Традиционно для шифрования информации используются два подхода: симметричные криптосистемы и асимметричные.
В симметричных методах шифрования применяется один и тот же ключ как для шифрования, так и для расшифрования данных. Обе стороны коммуникации должны знать этот ключ и хранить его в секрете.
При асимметричном шифровании используется два ключа: открытый и закрытый. Открытый ключ передаётся по незащищённому каналу и используется для проверки электронной подписи и шифрования сообщения.
Закрытый ключ используется для расшифрования сообщений и генерации электронной подписи. 

Асимметричные криптосистемы имеют ряд преимуществ перед симметричными: 
\begin{itemize}
  \item не нужно предварительно передавать секретный ключ по надёжному каналу,
  \item этот секретный ключ известен только одной стороне, 
  \item пару ключей можно долгое время не менять.
\end{itemize}

Однако есть и серьезные недостатки, которые не позволяют полностью перейти на использование асимметричных систем: 
\begin{itemize}
  \item в алгоритм сложно внести изменения, 
  \item ключи имеют большую длину,
  \item по сравнению с симметричными криптосистемами процесс шифрования и расшифрования медленнее на порядки, 
  \item требуются значительно большие вычислительные мощности для функционирования асиметричной криптосистемы. 
\end{itemize}

\subsection{Стойкость симметричного шифрования}
Итак, главное свойство симметричных шифров~--- в них используется один и тот же ключ $k$ для шифрования и расшифрования сообщения.
Это можно обозначить как $$ C = E_k(m),\ m = D_k(C), $$
\begin{itemize}
  \item[где] $E$~--- шифрующая функция,
  \item $D$~--- расшифровывающая функция,
  \item $m$~--- исходное сообщение,
  \item $C$~--- шифротекст.
\end{itemize}

Приведем теоретическое обоснование стойкости одного из наиболее важного метода шифрования~--- одноразового блокнота \cite{vernam_cryptosystem}.
Введем обозначения: \\
$ \mathbb{M}$~--- множество всевозможных открытых текстов $M$, \\
$ \mathbb{C}$~--- множество шифротекстов $C$, \\
$ \mathbb{K}$~--- множество ключей $K$.

На каждом из указанных множеств введена вероятность выбора соответствующего элемента.
Для возможности однозначного расшифрования сообщения, требуется $|\mathbb{C}| \ge |\mathbb{M}|.$
Кроме того, целесообразно полагать, что выбор ключа не должен зависеть от передаваемого сообщения: $p(M = m, K = k) = p(M = m) p(K = k).$

Пытаясь вскрыть шифр, Ева (этим именем в дальнейшем будем называть злоумышленника, перехватчика, подслушивателя) имеет задачу нахождения исходного сообщения $m$ по его шифротексту $c$. Вероятность решить эту задачу равна
$$ p(M = m | C = c) = \frac{p(M = m) p(C = c|M = m)}{p(C = c)}. $$
Цель Алисы и Боба (этими именами будем называть легитимных пользователей протокола) состоит в том, чтобы шифротекст давал как можно меньше информации об исходном сообщении.

Криптосистема называется абсолютно стойкой, если для всех открытых текстов $m$ и всех шифротекстов $c$ выполняется
$$ p(C = c|M = m) = p(M = m). $$
Если пары сообщения из $M$ и соответствующего ему шифротекста из $C$~-- статистически независимые случайные величины, 
то такая криптосистема обладает \textit{совершенной криптостойкостью}. 

Пусть сообщения $M$ и ключи $K$ являются независимыми случайными величинами. Это значит, что совместное распределение $P_{mk}(M, K)$ равно произведению отдельных распределений:
$$P_{mk}(M, K) = P_m(M) \cdot P_k(K).$$

Пусть $C = E_K(M)$~--- шифрованный текст, $M = D_K(C)$~--- расшифрованный текст. Можно найти $P_c(C)$, $P_{mck}(M, C, K).$

Оценим энтропию открытого текста $M$ с учетом статистической независимости $M$ и $C$:
$$H(M) = H(M|C) \leq H(MK|C) = H(K|C) + H(M|CK) = H(K|C) \leq H(K).$$

Так как энтропия открытого текста при заданном шифротексте и известном ключе равна нулю, то $H(M|CK) = 0$. В результате получаем
$$ H(M) \leq H(K). $$

С другой стороны, энтропия открытого текста $H(M)$ характеризует минимальную длину последовательности для описания случайной величины 
$M$ (открытого сообщения), а $H(K)$ характеризует минимальную длину последовательности для описания ключа. Получилось, что совершенная криптостойкость возможна 
только тогда, когда длина ключа не меньше, чем длина шифруемого сообщения, то есть
$$ H(M) \leq H(K). $$

Таким образом, приходим к теореме Шеннона:
\begin{theorem}
  Симметричная криптосистема, заданная набором $$ (\mathbb{M}, \mathbb{C}, \mathbb{K}, E_k(\cdot), D_k(\cdot)), $$
  где $|\mathbb{M}| = |\mathbb{C}| = |\mathbb{K}|$, является абсолютно стойкой тогда и только тогда, когда выполнены условия:
  \begin{enumerate}
    \item вероятности использования всех ключей равны: $p(K = k) = 1 / |\mathbb{K}|, \forall k \in \mathbb{K}$,
    \item для каждой пары сообщения $m \in \mathbb{M}$ и шифротекста $c \in \mathbb{C}$ существует только один ключ $k \in \mathbb{K}$ такой, что $E_k(m) = c$.
  \end{enumerate}
\end{theorem}


\subsection{Криптосистема Вернама}
Приведём пример системы с совершенной криптостойкостью.

Пусть сообщение представлено двоичной последовательностью длины $N$:
$$ m = (m_1, m_2, \cdots, m_N). $$

Распределение вероятностей сообщений $P_m(m)$ может быть любым. Ключ также представлен двоичной последовательностью $k =
(k_1, k_2, \cdots, k_N )$ той же длины, но с равномерным распределением $P_k(k) = \frac{1}{2^N}$
для всех ключей.

Шифрование в криптосистеме Вернама осуществляется путём покомпонентного суммирования по модулю 2 последовательностей открытого текста и ключа:
$$C = M \oplus K = (m_1 \oplus k_1, m_2 \oplus k_2, \cdots, m_N \oplus k_N ).$$

Легальный пользователь знает ключ и осуществляет расшифрование:
$M = C \oplus K = (m_1 \oplus k_1, m_2 \oplus k_2, \cdots, m_N \oplus k_N ).$

После выполнения этих операций ключ перестаёт использоваться, что объясняет другое название шифра Вернама~--- \textit{одноразовый блокнот}. 

Основная задача, к которой приводит использование симметричных криптосистем: как секретно передать секретный ключ?
Если в нашем распоряжении имеется надёжный канал, то отпадает и необходимость использовать какое бы то ни было шифрование.
В противном случае, в предположении о неограниченных вычислительных и иных возможностях злоумышленника (единственное условие: должны соблюдаться законы природы),
задача распределения ключей оказывается неразрешимой в классической физике. Однако, с помощью квантовой физики можно предъявить такой протокол распределения ключей, 
что какими бы возможностями не обладал злоумышленник (с учетом того же условия), легитимные пользователи либо получат общий секретный ключ, который не будет известен злоумышленнику,
либо любое вторжение злоумышленника в канал связи будет приводить к детектированию подслушивания.

\section{Основные понятия квантовой теории информации}
\subsection{Квантовые состояния}
При проведении первых опытов над элементарными частицами было обнаружено, что их поведение очень сложно увязать с имевшимися на тот момент представлениями о физических явлениях. Это привело к тому, что после формулировки новых законов, описывающих поведение элементарных частиц, эту часть физики стали называть квантовой теорией, а сложившуюся на тот момент физическую картину мира~--- классической.

\subsubsection{Волновая функция и чистые состояния}
Одно из главных отличий квантовой теории от классической проявляется в самом определении квантовой частицы и её состояния.
Представление о квантовой частице, как о некотором теле, имеющем определенные физические характеристики вроде координаты, размера или массы, оказалось в корне неверным, так как для некоторых частиц не удавалось даже понять, в какой точке пространства они в принципе находятся. Зато оказалось возможным предсказать, как эти частицы будут себя вести.
Трудность заключалась в том, что объяснить поведение частиц удалось только после окончательного отказа от попыток вычислить <<традиционные>> характеристики системы. Это привело к тому, что состояние элементарных частиц и их систем стали представлять с помощью <<волновой функции>>.

Введем понятие \textit{чистого квантового состояния}. 
Таким состоянием будем называть вектор в гильбертовом пространстве $\mathcal H$ с единичной нормой.
Под нормой вектора понимается корень его скалярного квадрата.

Будем обозначать вектор состояния, соответствующий состоянию $\psi$, как \state{\psi}. 
Сопряжённый вектор, соответствующий состоянию $\psi$, будем обозначать как \conjstate{\psi}. 
Скалярное произведение векторов \state{\psi}  и \conjstate{\phi}  будем обозначать как $\left\langle\phi|\psi\right\rangle$, 
а образ вектора \state{\psi} под действием оператора $\mathcal F$ будем обозначать $\mathcal F\state{\psi}$. 
Подобные обозначения в целом согласуются с обозначениями обычной линейной алгебры, но более удобны в квантовой механике, так как позволяют более наглядно и коротко называть используемые векторы.

Если мы рассмотрим два различных состояния, то суперпозиции (всевозможные линейные комбинации) пары соответствующих им векторов дадут двумерное линейное комплексное пространство.
При рассмотрении квантовой системы, состоящей из двух подсистем, пространство состояний строится в виде тензорного произведения. 

Для каждого чистого квантового состояния \state{\psi} можно определить соответствующий ему оператор
$\rho_\psi = \state{\psi} \conjstate{\psi}$, называемый \textit{оператором плотности}.
Этот оператор имеет единичный след, ранг 1 и действует как проектор на чистое состояние \state{\psi}.

\subsubsection{Смешанные состояния}
С помощью операторов плотности вводится общее понятие квантового состояния. \textit{Смешанным квантовым состоянием} называется статистическая смесь нескольких чистых состояний:
\begin{equation}
  \rho = \sum_i p_i \state{\psi_i}\conjstate{\psi_i}, \quad p_i \ge 0 \forall i, \quad \sum_i p_i = 1.
\end{equation}

Очевидно, что след смешанного состояния равен единице. Также несложно показать его положительную определенность:
\begin{equation}\label{positive_defined_operator}
  \conjstate{\varphi}\rho\state{\varphi} = \sum_i p_i |\scalar{\varphi}{\psi_i}|^2 \ge 0 \ \forall \state{\varphi} \in \mathcal{H}.
\end{equation}

Как известно, любой эрмитов оператор $A$ имеет спектральное разложение
\begin{equation}
  A = \sum_i \lambda_i \state{\lambda_i}\conjstate{\lambda_i},
\end{equation}
где собственные значения $\lambda_i$ вещественны, а собственные векторы \state{\lambda_i} ортогональны и нормированны. Это означает, что любой положительный эрмитов оператор с единичным следом можно назвать оператором плотности некоторого квантового состояния: из положительной определенности (\ref{positive_defined_operator}) следует положительность всех собственных значений (которые интерпретируются как вероятностные веса), а из условия единичного следа~--- то, что сумма собственных значений равна единице. В итоге это значит, что такая их комбинация может трактоваться как статистическая смесь, что приводит в общему определению квантового состояния.
\begin{definition}
  Квантовое состояние~--- положительный эрмитов оператор в гильбертовом пространстве с единичным следом.
\end{definition}

Квантовые состояния образуют выпуклое множество $\mathcal{S}(\mathcal{H})$ в пространстве операторов $\mathcal{H}$. Крайними точками этого множества являются чистые состояния, описывающиеся операторами ранга 1.

\subsubsection{Изменение состояний во времени}
Одним из ключевых законов квантовой механики является уравнение Шрёдингера, описывающее изменение квантовых состояний во времени. Традиционно это уравнение записывается как 
\begin{equation}\label{shroudinger_equation}
  i \hbar \frac{d \state{\psi}}{dt} = H \state{\psi}, 
\end{equation}

где $\hbar$~--- постоянная Планка. Эрмитов оператор $H$ называется гамильтонианом системы, и именно он оказывает влияние на её эволюцию.

Так как существует соответствие между унитарными и эрмитовыми операторами \cite{nielsen_chuang}:
\begin{equation} U = e^{iH}, \end{equation}
то уравнение (\ref{shroudinger_equation}) может быть переписано следующим образом:
\begin{equation} \state{\psi'} = U \state{\psi}.\end{equation}

Такой вид оказывается более удобным, так как он означает, что любая эволюция квантовой системы может быть представлена как действие некоторого унитарного преобразования.

\subsubsection{Принцип суперпозиции квантовых состояний}
Квантовая суперпозиция~--- это суперпозиция состояний, которые не могут быть реализованы одновременно с классической точки зрения, это суперпозиция альтернативных (взаимоисключающих) состояний.

Если функции  $\Psi_1$ и $\Psi_2$ являются допустимыми волновыми функциями, описывающими состояние квантовой системы, то их линейная суперпозиция, $\Psi_3 = c_1\Psi_1 + c_2\Psi_2$, также описывает какое-то состояние данной системы. 
Если измерение какой-либо физической величины  $\hat f$ в состоянии  $|\Psi_1\rangle$ приводит к определённому результату $f_1$, а в состоянии  $|\Psi_2\rangle$~-- к результату $f_2$, то измерение в состоянии $|\Psi_3\rangle$ приведёт к результату $f_1$ или $f_2$ с вероятностями $|c_1|^2$ и $ |c_2|^2$ соответственно.

\subsubsection{Кубиты}
Простейшим примером нетривиального квантового объекта является система с двумя базисными состояниями. 
Физическими примерами таких систем могут быть фотоны с соответствующими направлениями поляризации или направления спина электрона.
В этом случае соответствующее гильбертово пространство будет двумерным, его обозначают $\mathcal H^2$.
Если не важна конкретная физическая природа двухуровневой системы, её состояния обозначают как 
\state{0} и \state{1}. Такую систему называют \textit{кубитом} по аналогии с классическим битом.

Произвольное чистое состояние кубита можно записать как
\begin{equation} \state{\psi} = \cos \alpha \state{0} + \sin \alpha \state{1}. \end{equation}

\subsection{Измерения}
Именно процедура измерений квантовых состояний отличает квантовый случай проведения опытов от классического и даёт возможность применения квантовой криптографии. Важнейшим отличием квантовой механики от классической является тот факт, что в общем случае \textit{измерение квантовой системы меняет её исходное состояние}.

\subsubsection{Квантовые наблюдаемые}
В любом эксперименте можно выделить две его стадии: приготовление состояния $\rho$ и его измерение $M$. Измерение не обязано давать точно предсказуемый результат: в общем случае результат измерения~--- это статистический набор исходов $\{x\}$ с соответствующими вероятностями $\mu_\rho(x)$. Естественно требовать, чтобы для статистических ансамблей квантовых состояний результаты их наблюдения также были бы статистическими смесями результатов наблюдения соответствующих отдельных состояний ансамбля. Такое требование называется требованием аффинности:
\begin{equation} \mu_\rho(x) = \sum_i p_i \mu_{\rho_i}(x),\quad \rho = \sum_i p_i \rho_i, \end{equation}
где $p_i$~--- вероятности, с которыми каждое состояние входит в ансамбль состояний.
Этого требования достаточно для следующего утверждения \cite{holevo}.
\begin{theorem}
  Пусть $\rho \rightarrow \mu_\rho$~--- аффинное отображение множества квантовых состояний в вероятностные распределения на конечном множестве $X$. Тогда существует семейство эрмитовых операторов $\{M_x\}$ такое, что
  \begin{equation} M_x \ge 0,\quad \sum_{x \in X} M_x = I,\quad \mu_\rho(x) = \tr \rho M_x. \end{equation}
\end{theorem}

Эта теорема говорит о том, что измерение квантовой системы можно связать с набором положительных эрмитовых операторов, сумма которых равна единичному оператору. В этом случае вероятность каждого из исходов равна следу произведения состояния и оператора, соответствующего данному исходу. Это приводит к определению квантовой наблюдаемой.
\begin{definition}
  Квантовая наблюдаемая со значениями из множества $X$~--- набор эрмитовых операторов $\{M_x\}_{x \in X}$ таких, что
  \begin{equation} M_x \ge 0,\quad \sum_{x \in X} M_x = I. \end{equation}
\end{definition}

Такой набор операторов называют разложением единицы.

Из теоремы следует, что при измерении состояния $\rho$, описываемого разложением единицы $\{M_x\}$, вероятность получить каждый из исходов $x$ равна
\begin{equation} \pr(x|\rho) = \tr M_x \rho, \end{equation}
а для чистого состояния \state{\psi} в силу свойств следа эта вероятность выражается более просто:
\begin{equation} \pr(x|\rho_\psi) = \conjstate{\psi} M_x \state{\psi}. \end{equation}

\subsubsection{Коллапс волновой функции}
Важным законом квантовой механики является коллапс волновой функции, или редукция. Это свойство означает переход состояния после измерения в одно из собственных состояний оператора измерения. Так, при измерении $\{M_i\}$ и получении результата $i$ исходное состояние будет преобразовано в 
\begin{equation} \rho'_i = \frac{\sqrt{M_i} \rho \sqrt{M_i}}{\tr M_i \rho}. \end{equation}

Это одно из важнейших для квантовой криптографии свойств, поскольку оно говорит о том, что попытки измерить систему ведут к помехам. Из этого следует, что попытки перехвата информации всегда можно детектировать по ошибкам на приёмной стороне.

\subsubsection{Невозможность достоверного различения неортогональных состояний}
Невозможность достоверного различения неортогональных квантовых состояний \cite{non_orthogonal_states_discrimination_theorem}~--- важный результат, на котором также во многом основывается секретность протоколов квантовой криптографии.

Этот результат можно сформулировать следующим образом: для чистых состояний \state{\psi_0} и \state{\psi_1} таких, что
$\scalar{\psi_0}{\psi_1} = \cos \alpha \neq 0$, не существует измерения $\{M_0, M_1\}$, которое давало бы точный результат, то есть соответствовало бы условиям
\begin{eqnarray}\label{measurement_operators_conditions}
  \conjstate{\psi_0} M_0 \state{\psi_0} = 1,\quad \conjstate{\psi_1} M_0 \state{\psi_1} = 0, \nonumber\\
  \conjstate{\psi_0} M_1 \state{\psi_0} = 0,\quad \conjstate{\psi_1} M_1 \state{\psi_1} = 1.
\end{eqnarray}

Докажем это утверждение. Допустим, такое измерение существует. Рассмотрим представление \state{\psi_1} как линейную комбинацию состояния \state{\psi_0} и его нормированного ортогонального дополнения \state{\psi_0^\bot}:
$$ \state{\psi_1} = a\state{\psi_0} + b\state{\psi_0^\bot},\quad |a^2| + |b^2| = 1. $$
Так как \state{\psi_0} и \state{\psi_1} неортогональны, то $0 < |a| < 1,\  0 < |b| < 1$.
Из условий на операторы очевидно следует, что $\sqrt{M_1}\state{\psi_0} = 0$, а значит,
$$ \sqrt{M_1}\state{\psi_1} = \sqrt{M_1} a\state{\psi_0} + \sqrt{M_1} b\state{\psi_0^\bot} = 
\sqrt{M_1} b\state{\psi_0^\bot}, $$
из чего следует, что равенство в (\ref{measurement_operators_conditions}) можно записать как
$$ \conjstate{\psi_1} M_1 \state{\psi_1} = |b^2| \conjstate{\psi_0^\bot} M_1 \state{\psi_0^\bot} \leq |b^2|, $$
что противоречит (\ref{measurement_operators_conditions}) в силу $|b| < 1$. Полученное противоречие доказывает невозможность различения неортогональных состояний.

\subsubsection{Четкие и нечеткие наблюдаемые}
Обычно под наблюдаемой подразумевают только ортогональное разложение единицы. Такие наблюдаемые будем называть \textit{четкими наблюдаемыми}\cite{holevo}. В то же время требование взамной ортогональности всех операторов не является обязательным, а в некоторых случая выгоднее пользоваться наблюдаемыми, в которых не все операторы ортогональны друг другу, в целях получения максимального количества информации. Такие наблюдаемые называются нечеткими.

На первый взгляд нечеткие наблюдаемые просто смешивают вероятности разных исходов и не могут принести дополнительной пользы. Однако это не так.
Рассмотрим пример, как нечеткая наблюдаемая может помочь различить неортогональные состояния \state{\phi} и \state{\psi}:

$$ \scalar{\phi}{\psi}  = \cos \eta.$$

Одно из возможных измерений для такой пары состояний принято называть <<измерение с тремя исходами>>, и оно использует три результата: $\{0, 1, ?\}$. Соответствующие эрмитовы операторы равны

\begin{eqnarray}
  M_0 = \frac{\state{\psi^\bot}\conjstate{\psi^\bot}}{1 + \cos \eta} = \frac{I - \state{\psi}\conjstate{\psi}}{1 + \cos \eta}, \nonumber\\
  M_1 = \frac{\state{\phi^\bot}\conjstate{\phi^\bot}}{1 + \cos \eta} = \frac{I - \state{\phi}\conjstate{\phi}}{1 + \cos \eta}, \\
  M_? = I - M_0 - M_1. \nonumber
\end{eqnarray}

Несложно обнаружить, что 
$$ \tr M_0 \state{\psi}\conjstate{\psi} = \conjstate{\psi} M_0 \state{\psi} = \frac{\scalar{\psi}{\psi^\bot} \scalar{\psi^\bot}{\psi}}{1 + \cos \eta} = 0, $$
и аналогично $\tr M_1 \state{\phi}\conjstate{\phi} = 0$. Это значит, что при применении такого измерения нет шансов получить исход 0 при измерении состояния \state{\phi}, а при измерении состояния \state{\psi} не может получиться исход 1. Это значит, что такое измерение позволяет различать неортогональные состояния без ошибок. Цена этого~--- некоторая вероятность (равная $\cos \eta$) получить несовместный исход <<?>>, который соответствует уклонению от ответа.

\subsection{Составные квантовые системы}
Рассмотрение квантовых систем из нескольких частиц может привести к интересным свойствам, которые не встречаются в классическом случае. Еще в переписке Эйнштейна, Подольского и Розена \cite{epr_paradox} были отмечены необычные свойства составных квантовых систем, которые противоречили локальности: получалось, что действия над одной подсистемой могут мгновенно оказывать влияние на другую подсистему вне зависимости от расстояния между ними. 
\subsubsection{Тензорное произведение}
Для начала определим, в каком пространстве находятся составные квантовые системы.

Рассмотрим наиболее простой случай двух кубитов. Интуитивно понятно, что возможны 4 варианта их совместного состояния:
\begin{itemize}
  \item оба кубита в состоянии \state{0};
  \item первый кубит в состоянии \state{0}, второй~-- в состоянии \state{1};
  \item первый кубит в состоянии \state{1}, второй~-- в состоянии \state{0};
  \item оба кубита в состоянии \state{1}.
\end{itemize}
Именно эти четыре вектора и будут являться базисными в пространстве двух кубитов.

Формально это описывается следующим образом. Если есть пространства $\mathcal{H}_1$ и $\mathcal{H}_2$ c размерностями $d_1$ и $d_2$ и ортонормированными базисами $\{e_i\}$ и $\{f_i\}$, то можно определить пространство с базисом $\{e_i \otimes f_j\},\, i = \overline{1,d_1},\, j = \overline{1,d_2}$. Если ввести на этом пространстве скалярное произведение
$$ \scalar{e_i \otimes f_j}{e_m \otimes f_n} = \scalar{e_i}{e_m} \cdot \scalar{f_j}{f_n} $$ и продолжить его по линейности на остальные векторы, то в результате получим гильбертово пространство, называемое тензорным произведением $\mathcal{H}_1$ и $\mathcal{H}_2$, обозначаемое $\mathcal{H}_1 \otimes \mathcal{H}_2$.

Тензорное произведение операторов $A_1 \in \mathcal{S}(\mathcal{H}_1)$ и $A_2 \in \mathcal{S}(\mathcal{H}_2)$~--- оператор $A_1 \otimes A_2$ в пространстве $\mathcal{H}_1 \otimes \mathcal{H}_2$, который действует по закону
$$ (A_1 \otimes A_2)\state{e_1 \otimes e_2} = (A_1\state{e_1})\otimes(A_2\state{e_2}). $$

Встает вопрос о том, всякое ли состояние в пространстве $\mathcal{H}_1 \otimes \mathcal{H}_2$ можно задать как тензорное произведение состояний из частичных пространств $\mathcal{H}_1$ и $\mathcal{H}_2$. Ответ на него отрицателен.
Классическим контрпримером является состояние в пространстве двух кубитов, называемое ЭПР:
$$\state{\psi_{EPR}} = \frac{\state{00} + \state{11}}{\sqrt{2}}.$$
Легко видеть, что это состояние невозможно представить в виде тензорного произведения одночастичных состояний: 
$$\state{\psi_{EPR}} \neq (a_1\state{0} + b_1\state{1}) \otimes (a_2 \state{0} + b_2 \state{1}).$$

\subsubsection{Частичный оператор плотности и частичные измерения}
После определения тензорного произведения операторов плотности возникает необходимость определить обратную операцию, с помощью которой можно было бы по состоянию $\rho_1 \otimes \rho_2 \in \mathcal{H}_1 \otimes \mathcal{H}_2$ получить исходные операторы $\rho_1 \in \mathcal{H}_1$ и $\rho_2 \in \mathcal{H}_2$. Такая операция называется взятием частичного следа и определяется следующим образом:
$$ \tr_{\mathcal{H}_2}\rho_{12} = \sum_{i,j,k} \state{e_i}\conjstate{e_j} \conjstate{e_i \otimes f_k} \rho_{12} \state{e_j \otimes f_k}. $$
Аналогично для частичного следа по первому подпространству:
$$ \tr_{\mathcal{H}_1}\rho_{12} = \sum_{i,j,k} \state{f_i}\conjstate{f_j} \conjstate{e_k \otimes f_i} \rho_{12} \state{e_k \otimes f_j}. $$

По определению этой операции видно, что:
$$\tr_{\mathcal{H}_2} \rho_1 \otimes \rho_2 = \rho_1,$$
$$\tr_{\mathcal{H}_1} \rho_1 \otimes \rho_2 = \rho_2.$$

Рассмотрим теперь ситуацию, когда квантовое состояние распределено между двумя участниками, один из которых производит измерение над своей подсистемой. Такое действие называют частичным измерением.

При измерении одной подсистемы над второй не производится активных действий, поэтому в разложении единицы, описывающем общее измерение, все операторы, соответствующие второй подсистеме, будут тождественными. Например, если перый участник применяет измерение $\{\conjstate{0}\state{0}, \conjstate{1}\state{1}\}$, то в составной системе это измерение будет выглядеть так:
$$M_0 = \state{0}\conjstate{0}_1 \otimes I_2,\qquad M_1 = \state{1}\conjstate{1}_1 \otimes I_2.$$
Стоит заметить, что несмотря на тождественные операторы в правой части, измерение первой подсистемы в общем случае влияет на состояние второй подсистемы.

\subsubsection{Квантовая запутанность}
Квантовая запутанность~--- квантовомеханическое явление, при котором квантовые состояния двух или большего числа объектов оказываются взаимозависимыми. Такая взаимозависимость сохраняется, даже если эти объекты разнесены в пространстве за пределы любых известных взаимодействий, что находится в логическом противоречии с принципом локальности. 
Например, можно получить пару фотонов, находящихся в запутанном состоянии, и тогда если при измерении спина первой частицы спиральность оказывается положительной, то спиральность второй всегда оказывается отрицательной, и наоборот.

Рассмотрим состояние ЭПР в пространстве двух кубитов
$$\state{\psi_{EPR}} = \frac{\state{00} + \state{11}}{\sqrt{2}}$$
и посмотрим, что будет, если провести измерение над первой подсистемой. При выпадении исхода 0 начальное состояние перейдет в 
$$ \frac{\sqrt{M_0}\state{\psi_{EPR}}\conjstate{\psi_{EPR}}\sqrt{M_0}}{ \conjstate{\psi_{EPR}}M_0\state{\psi_{EPR}}} = \state{00}\conjstate{00}, $$ что соответствует чистому состоянию \state{00}. Аналогично при исходе 1 начальное состояние перейдет в \state{11}. Это говорит об удивительном факте: измерение одной части квантового состояния может изменять все состояние в целом.

Это свойство имеет место не для произвольных квантовых состояний, а только для запутанных. Запутанные состояния определяются как состояния в составном пространстве, которые нельзя представить в виде тензорного произведения состояний в каждом из частичных пространств.

Для состояний, которые не являются запутанными, подобное свойство не имеет места: измерение одной подсистемы никак не влияет на состояние второй.

\subsubsection{Невозможность клонирования квантовых состояний}
В квантовой криптографии важен еще один результат из теории составных квантовых систем. Выше было показано, что неортогональные квантовые состояния нельзя достоверно различить. Здесь будет показано, что такие состояния нельзя и клонировать \cite{no_cloning_theorem}~--- например, чтобы собрать более полную статистику результатов измерений.

Преобразование U, клонирующее произвольное чистое состояние \state{\psi}, можно описать так:
$$U\state{\psi}\otimes\state{A} = \state{\psi}\otimes\state{\psi},$$
где \state{A}~--- исходное состояние вспомогательной системы.

Чтобы показать невозможность такого преобразования, достаточно рассмотреть его действие на базисные состояния \state{0} и \state{1}:
\begin{eqnarray}\label{no_cloning_proof_bases}
  U\state{0}\otimes\state{A} = \state{0}\otimes\state{0}, \nonumber\\
  U\state{1}\otimes\state{A} = \state{1}\otimes\state{1},
\end{eqnarray}
а также на состояние $\frac{1}{\sqrt{2}}(\state{0} + \state{1})$. В силу линейности оператора $U$ и соотношений \ref{no_cloning_proof_bases} должно выполняться
$$U(\frac{1}{\sqrt{2}}(\state{0} + \state{1}) \otimes \state{A}) = \frac{1}{\sqrt{2}}(\state{0} \otimes \state{0} + \state{1} \otimes \state{1}).$$
С другой стороны, по определению $U$ должно получаться
$$U(\frac{1}{\sqrt{2}}(\state{0} + \state{1}) \otimes \state{A}) = \frac{1}{2}(\state{0} + \state{1}) \otimes (\state{0} + \state{1}).$$

Полученное противоречие доказывает невозможность клонирования произвольных квантовых состояний. Стоит отметить, что клонировать состояния из ортогонального набора можно: для этого достаточно их измерить и приготовить состояние, соответствующее результату измерения.

\section{Базовые протоколы квантового распределения ключей}
К 1984 году основная часть описанных результатов уже была известна, и их оказалось достаточно для того, чтобы сформулировать принципы квантовой криптографии и предоставить доводы в пользу секретности такого способа распределения ключей. 

Основные факты квантовой теории информации, на которых основывается квантовая криптография~--- связанные между собой утверждения о невозможности клонирования произвольных квантовых состояний и о невозможности достоверного различения неортогональных состояний. В сочетании эти результаты дают тот факт, что попытки различения квантовых состояний из неортогонального набора ведут к помехам, а значит, действия перехватчика могут быть детектированы по величине ошибки на приемной стороне.

Важно заметить, что квантовая криптография не делает никаких предположений о характере действий подслушивателя и объеме доступных ему ресурсов: предполагается, что перехватчик может обладать любыми ресурсами и делать все возможные действия в рамках известных на сегодняшний день законов природы. Это существенно отличает квантовую криптографию от классической, которая опирается на ограничения в вычислительной мощности подслушивателя.

\subsection{Протокол BB84}
Неформально принцип действия всех протоколов квантовой криптографии можно описать следующим образом. Передающая сторона (Алиса) на каждом шаге посылает одно из состояний из неортогонального набора, а принимающая сторона (Боб) производит такое измерение, что после дополнительного обмена классической информацией между сторонами они должны иметь битовые строки, полностью совпадающие в случае идеального канала и отсутствия перехватчика. Ошибки в этих строках могут говорить как о неидеальности канала, так и о действиях подслушивателя. При величине ошибки, превышающей некоторый предел, действие протокола прерывается, иначе же легитимные пользователи могут извлечь полностью секртеный ключ из этих частично совпадающих битовых строк.

\subsubsection{Общая схема протокола}
Протокол BB84 \cite{bb84} использует два базиса:
\begin{gather}
  +: \state{0^+} = \state{0},\quad \state{1^+} = \state{1}, \nonumber\\
  \times: \state{0^\times} = \frac{1}{\sqrt{2}}(\state{0} + \state{1}),\quad \state{1^\times} = \frac{1}{\sqrt{2}}(\state{0} - \state{1}).
\end{gather}

На этапе приготовления состояний Алиса случайным образом выбирает один из указанных базисов, а затем случайно выбирает значение бита: 0 или 1, и в соответствии с этим выбором посылает один из четырех сигналов. При посылке каждого из этих сигналов Алиса запоминает свой выбор базиса и выбор бита, что приводит к появлению на ее стороне двух случайных битовых строк.

Боб, получая каждый из присланных Алисой сигналов, производит над ним одно из двух измерений случайным образом. Каждое из них способно дать достоверный резлуьтат из-за ортогональности состояний внутри каждого базиса:
\begin{eqnarray}
  M_0^+ = \state{0^+}\conjstate{0^+}, \qquad M_1^+ = \state{1^+}\conjstate{1^+}, \nonumber\\
  M_0^\times = \state{0^\times}\conjstate{0^\times}, \qquad M_1^\times = \state{1^\times}\conjstate{1^\times}.
\end{eqnarray}
В результате он получает две строки: с выбором базисов и с исходами этих измерений.

Итак, после передачи всех состояний и проведения измерений Алиса и Боб имеют по две строки каждый. Теперь происходит согласование базисов: по открытому каналу Алиса и Боб объявляют друг другу свои строки с выбором базисов. Те посылки, в которых базисы не совпали, выбрасываются. Если базис Алисы совпал с базисом Боба, то в случае отсутствия помех в канале связи результаты в их битовых строках на соответствующей позиции также будут совпадать, поэтому после этапа согласования в случае идеального канала и отсутствия действий со стороны перехватчика Алиса и Боб обладают одними и теми же битовыми строками.

Но если в канале были ошибки или перехватчик пытался подслушать информацию, битовые строки Алисы и Боба могут не совпадать, поэтому для проверки они должны согласованно раскрыть примерно половины своих битовых строк. Согласно центральной предельной теореме, ошибка в раскрытой битовой последовательности дает достаточно точную оценку ошибки во всей последовательности, и по ней можно достаточно точно оценить вероятность ошибки в оставшихся позициях. Если величина ошибки оказывается больше некоторой величины (параметра протокола), передача данных прекращается: это означает, что перехватчик обладает слишком большой информацией о ключе. В противном случае перед Алисов и Бобом стоит задача получения общего секретного ключа, которую можно разбить на два этапа: сначала производится коррекция ошибок \cite{information_reconcilation}, после чего у Алисы и Боба оказываются совпадающие битовые строки; затем происходит усиление секретности \cite{privacy_amplification}, которое ставит своей целью исключить информацию о ключе, которая могла попасть к перехватчику в результате действий над состояниями или в ходе коррекции ошибок. В конечном итоге у перехватчика не должно остаться информации об общей битовой строке Алисы и Боба.

\subsubsection{Стойкость протокола}
При предложении протокола BB84 его стойкость была показана только на интуитивном уровне: попытка Евы измерить передаваемые состояния влечет к их разрушению, что приводит к ошибкам на приемной стороне.
Однако только измерениями посылаемых сигналов действия Евы не ограничиваются. Более того, непросто рассчитать информацию, способную попасть к Еве при всех возможных действиях с ее стороны. Однако оказалось, что можно доказать стойкость протокола BB84, не прибегаю к оценкам информационных величин для всех возможных атак Евы. В 2000 году было показано \cite{shor_bb84_security_proof}, что секретность квантовой криптографии можно свести к свойствам квантовых кодов коррекции ошибок: если ошибки, возникающие в квантовом канале связи, можно достоверно исправить, то можно добиться и секретной передачи данных. Это дает критическую величину ошибки, до которой возможно секретное распределение ключей. 

Доказательство стойкости протокола проще всего провести, введя несколько дополнительных протоколов. Так, стойкость введенного первым ЭПР-протокола \cite{e91} легко вытекает из теории квантовых измерений, а последовательным изменением некоторых действий легитимных пользователей он может быть сведен к более строго описанному протоколу BB84 без нарушения исходной секретности \cite{lo_chau, protocol_css}.

Схема протокола, рассмотренная в \cite{protocol_css}, незначительно отличающаяся от описанной выше, использует для коррекции ошибок и усиления секретности свойства CSS-кодов, который не являются оптимальными. Теоретическая оценка на величину ошибки $q$, которую можно исправить в квантовом канале, дается границей Шеннона: $1-2h(q) > 0$. 
Достижение этой границы сводится к использованию случайных классических кодов. Теоретический предел ошибки, до которой возможно секретное распределение информации, равен примерно $11\%$, а именно корню уравнения $1 - 2h(q) = 0$.

\subsubsection{Стратегии подслушивателя}
Итак, утверждается, что при величине ошибки на приемной стороне менее $11\%$ возможна секретная передача данных. В то же время не говорится о том, каким образом протокол теряет секретность при большей величине ошибки. В этом разделе рассмотрены некоторые схемы атаки, на одной из которых достигается теоретический предел ошибки на приемной стороне.
\paragraph{Прием-перепосыл}
Наиболее простой сценарий действий Евы~--- измерение передаваемого по квантовому каналу состояния с дальнейшим пересылом получившегося результата дальше. Именно таким образом прослушиваются классические каналы. В квантовом случае такая стратегия не работает.

Если Ева стремится произвести те же действия, что производит у себя Боб, то, не знаю исходного состояния, она сталкивается с нерешаемой проблемой различения состояний из неортогонального набора. 
Применяя случайным образом одно из измерений
\begin{eqnarray}
  +: M_0^+ = \state{0^+}\conjstate{0^+}, \quad M_1^+ = \state{1^+}\conjstate{1^+}, \nonumber\\
  \times: M_0^\times = \state{0^\times}\conjstate{0^\times}, \quad M_1^\times = \state{1^\times}\conjstate{1^\times}
\end{eqnarray}
к посланному состоянию, в половине случаев Ева будет неверно укадывать базис. В силу свойства несмещенности базисных состояний при неверно угаданном базисе вероятность ошибки евы состоавляет $50\%$, то есть Ева не получает полезной информации о сигнале.

Но это не все проблемы Евы. Неверно угаданный базис при проведении измерения вследствие коллапса волновой функции неизбежно приведет к тому, что Бобу будет послано ошибочное состояние. При применении измерения ``$+$'' вне зависимости от исходного состояния дальше будет послано одно из состояний набора $\{\state{0^+}, \state{1^+}\}$, аналогично с диагональным базисом ``$\times$''. Измеряя эти состояния в <<верном>> для них базисе, Боб получит ошибку, по которой действия Евы будут обнаружены.

Величину ошибки на приемной стороне можно вычислить так. Допустим, Ева подвергала атаке не все состояния, а только их часть, атакуя каждый сигнал с вероятностью $p$. Тогда доля $1-p$ сигналов приходит к Бобу без ошибки (а Еве приходится просто угадывать значение бита в таких посылках, что вносит в ее ошибку вклад, равный $(1-p)/2$). 
Для посылок, атакованных Евой, существует два равновероятных развития событий:
\begin{itemize}
  \item Ева верно угадала базис, значит, точно получила информацию и не внесла возмущения.
  \item Ева ошиблась в выборе базиса. Тогда с вероятностью $1/2$ она получила ошибочный результат. Кроме того, совершенно точно она передала ошибочное состояние Бобу, что приводит к появлению ошибки на его стороне, вероятность которой также равна $1/2$. 
\end{itemize}

Вероятность каждого из этих сценариев равна $p/2$, и нетрудно видеть, что доля ошибок на приемной стороне будет равна $p/4$, а доля ошибок у Евы составит $$\frac{1}{2} - \frac{p}{4}.$$

Это значит, что при всех значениях параметра $p$, меньших единицы, Ева имеет больше ошибок, чем Боб, и тогда ее информация о ключе строго меньше. При $p=1$ доли ошибок у Боба и Евы совпадают и равны $25\%$. Так как ошибка Боба однозначно связана с параметром $p$, то 25\%~--- пороговая величина ошибки для такой атаки, до которой возможно секретное распределение ключей.

\paragraph{Коллективная атака}
Критическая ошибка индивидуального подслушивания, равная 25\% превосходит теоретический порог в 11\%. Возникает вопрос, как Еве нужно изменить схему атаки, чтобы добиться лучших результатов? Оказывается, что слабая сторона индивидуальной атаки~--- в проведении измерений над каждым передаваемым состоянием по отдельности. Из свойства супераддитивности  классически-квантового канала\cite{holevo} следует, что выгоднее проводить измерение над всей последовательностью полученных состояний сразу. В \cite{bb84_collective_attack} показано, что критическая ошибка $Q_c$ для коллективной атаки равна корню уравнения $1 - h(Q_c) = h(Q_c)$, что совпадает с полученным выше теоретическим пределом.

\begin{comment}
\paragraph{Атака с измерениями с тремя исходами} 
Наибольший интерес (в частности для релятивистской квантовой криптографии) представляет собой атака, в которой используются рассмотренные выше измерения с тремя исходами. Суть ее состоит в следующем.
Ева перехватывает каждую отдельную посылку от Алисы к Бобу и проводит над ней измерение с тремя исходами.
Если она получила определенный результат, то она точно знает, какое состояние посылала Алиса, и может приготовить такое же для отправки его дальше Бобу. Если же был получен неопределенный результат, то Еве остается только угадать правильное состояние
\end{comment}
\subsection{Протокол B92}
Протокол BB84 является первым и наиболее изученным протоколом квантовой криптографии. Однако попытки его техничесокй реализации столкнулись с рядом технических трудностей (о них ниже), в результате чего Ева может провести перехват информации, невозможный при строгой реализации всех принципов протокола BB84. Появилась необходимость разработки протоколов, способдных противостоять Еве и на современном уровне развития технологий.

В протоколе BB84 при отсутствии действий перехватчика и помех в канале вероятность ошибки на приемной стороне до согласования базисов составляет 25\%. Это вызвано использованием строго зафиксированной конфигурации двух пар базисных векторов. Цель протокола B92 \cite{non_orthogonal_states_discrimination_theorem} состоит в возможности изменения этого параметра в зависимости от, например, длины канала или его качества. В ряде случаев это позволяет добиться большей скорости передачи данных.

На каждом шаге протокола B92 Алиса посылает Бобу одно из двух неортогональных состояний \state{\psi_0}, \state{\psi_1}, где $\scalar{\psi_0}{\psi_1} = \cos \eta$~--- основной параметр протокола. На стороне Боба производится измерение с тремя исходами
\begin{eqnarray}
  M_0 = \frac{I - \state{\psi_1}\conjstate{\psi_1}}{1 + \cos \eta}, \nonumber\\
  M_1 = \frac{I - \state{\psi_0}\conjstate{\psi_0}}{1 + \cos \eta}, \nonumber\\
  M_? = I - M_0 - M_1.
\end{eqnarray}
Посылки, в которых был получен несовместный исход, отбрасываются.

После передачи всех сообщений Алиса и Боб, так же как в BB84, согласованно раскрывают часть своих битовых последовательностей и оценивают число ошибок. Если их оказалось больше некоторой величины, выполнение протокола прерывается, иначе из оставшейся части можно получить полностью секретный ключ. Стойкость протокола относительно наиболее эффективной атаки Евы (коллективной) была исследована в \cite{b92_security_proof}.

\subsection{Проблемы практических реализаций}
Несмотря на заявления о теоретической секретности указанных протоколов, на практике возникают различные трудности.
Первая из них~--- в настоящее время не существует строго однофотонного источника. Современные лазеры выдают так называемые когерентные состояния:
$$\state{\alpha} = e^{-\frac{\mu}{2}} \sum_{n=0}^\infty \frac{\alpha^n}{\sqrt{n!}} \state{n} = e^{-\frac{\mu}{2}}(\state{0} + \alpha \state{1} + \frac{\alpha^2}{2}\state{2} + \cdots), $$
где $\mu = |\alpha|^2$~--- среднее число фотонов, $\state{0} \equiv \state{vac}$~--- вакуумное состояние с числом фотонов 0. Значение параметра $\mu$ находится в районе 0.1-0.2, что дает вероятность вакуумного состояния примерно 0.9, вероятность, что в посылке будет ровно один фотон~---0.09, ровно два фотона~---0.009 и т. д.

Проблема неоднофотонных источников дополняется второй~--- помехи и потери в квантовом канале связи. Эти два фактора дают возможность провести атаку с расщеплением фотонов \cite{pns_attack}. Вкратце, Ева может определить число фотонов в посылке. Если их более одного, то она отщепляет себе один фотон, а оставшуюся часть отправляет Бобу. Если фотон в посылке ровно один, эта посылка блокируется и Бобу ничего не посылается, таким образом имитируется потеря посылки из-за плохого качества канала.
После передачи всех состояний у Евы будут храниться фотоны на каждую из принятых Бобом посылок. После раскрытия базисов она проводит соответствующие измерения и полностью знает секретный ключ, не вызвав при этом никаких ошибок на приемной стороне.

Однако, даже если в распоряжении Алисы имеется строго однофотонный источник, то при наличии потерь в канале Ева все равно может узнать \cite{uds_attack} секретный ключ и остаться незамеченной следующим образом. Над каждой посылкой проводится измерение с тремя исходами. Если был получен совместный результат, Ева точно знает, какое состояние приготовила Алиса, поэтому может приготовить такое же и послать его Бобу. В случае несовместного результата посылка блокируется. Такая стратегия не производит никаких ошибок на приемной стороне.

\subsection{Релятивистское квантовое распределение ключей}
Возникает принципиальный вопрос: существуют ли такие протоколы квантового распределения ключей, которые обеспечивают безусловную секретность при не строго однофотонном источнике и произвольных потерях в канале связи? Ответ на этот вопрос: да, существуют. Но для их построения недостаточно опираться исключительно на законы квантовой механики, как это делают все базовые протоколы (BB84\cite{bb84}, B92\cite{non_orthogonal_states_discrimination_theorem}, SARG04\cite{sarg04}. decoy-state\cite{decoy_states_protocol}, phase-time coding\cite{phase_time_protocol}). 

Все эти протоколы не используют тот факт, что фотоны движутся с предельно возможной скоростью света. 
В релятивитской схеме квантового распределения ключей всё взаимодействие происходит в пространстве-времени Минковского, и существенно используется ограничение специальной теории относительности на невозможность движения со скоростями больше скорости света. Основная идея релятивистской схемы состоит в том, чтобы <<растянуть>> информацию и в пространстве, и во времени. Для того, чтобы Ева смогла получить эту информацию, ей придется собрать все части вместе, так как по отдельности они абсолютно бесполезны. Для такого сбора потребуется некоторое время. После получения данных эту информацию потребуется снова разнести в пространстве-времени, на что так же потребуется время. В итоге Ева будет вызывать детектируемые задержки.

Учет фундаментальных ограничений, накладываемых специальной теорией относительности, приводит к тому, что возможна передача секретных ключей на любые расстояния через открытое пространство даже при не строго однофотонном источнике и любых потерях в канале связи.

\begin{comment}
Квантовое распределение ключей (QKD)~--- концепт секретного распределения ключей, основанный на фундаментальных законах квантовой механики.
Квантовая криптография \cite{bennett1984QuacryPubkeydiscoitos, ekert1991QuacrybasBelthe, gisin2002Quacry, scarani2009secpraquakeydis, hughes2011Refquacry, lam2013QuacryConimp} приобрела популярность за обещание абсолютной секретности против подслушивания. <<Абсолютной>> понимается в том смысле, что секретность гарантирована
фундаментальными запретами квантовой механики (на копирование неизвестного квантового состояния и невозможности достоверной различимости неортогональных квантовых состояний) \cite{bennett1984QuacryPubkeydiscoitos, bennett1992Quacryusianytwononsta, wootters1982sinquacanbeclo, dieks1982CombyEPRdev}, 
а не нашими технологическими возможностями. Достоверная неразличимость неортогональных квантовых состояний приводит к тому, что любые попытки вторжения в канал связи с целью получения информации о передаваемых состояниях вызывают их неизбежное возмущение, что ведет к ошибкам на приемной стороне и детектированию подслушивателя.
Если ошибка на приемной стороне не превосходит некоторой критической величины\footnote{Величина критической ошибки определяется конкретным протоколом}, то ошибки могут быть исправлены через аутентичный открытый классический канал связи. В результате последующего сжатия (хеширования \cite{bennett1995Genpriamp}) очищенного ключа возникает секретный ключ, известный только двум легитимным пользователям.

Однако, \textit{практические} схемы реализации QKD~--- серьезный вызов для ученых, так как все реализации так или иначе отличаются от теоретических моделей. 
Две основные проблемы всех существующих реализаций, ни одна из которых не может быть эффективно устранена: 
\begin{inparaenum}[\itshape 1\upshape)]
\item любой существующий в настоящее время источник фотонов имеет ненулевую вероятность испустить два или более фотонов одновременно, в то время как в теории нужен ровно один \cite{lounis2000Sinphodemsinmolrootem, benjamin2000Sinphodem}, и
\item наличие потерь в квантовом канале связи.
\end{inparaenum}

В реальной ситуации неоднофотонность источника вместе с потерями в квантовом канале связи приводит к тому, что все базовые протоколы распредения ключей: BB84, B92, SARG04, decoy-state (с состояниями-ловушками), phase-time (фазово-временное кодирование) оказываются неустойчивыми относительно PNS атаки (атака с расщеплением по числу фотонов) и не гарантируют секретность ключей, если длина квантового канала связи превышает некоторую критическую величину. 

Протоколы используются как в оптоволоконных системах квантовой криптографии, так и в системах, работающих через открытое пространство.
Конечной целью работ по квантовой криптографии в открытом пространстве является создание глобальной системы распределения ключей на большие расстояния через низкоорбитальные спутники. 
При передаче ключей через открытое пространство могут быть использованы протоколы, стойкость которых базируется на запретах только квантовой механики, применяемые в оптоволоконных системах квантовой криптографии. 
Однако при не строго однофотонном источнике квантовых состояний и потерях в канале связи дальность передачи секретных ключей при помощи таких протоколов ограничена \cite{scarani2009secpraquakeydis}. 
В принципе можно сформулировать протоколы, дальность которых не ограничена, но при этом неизбежно требуются априорное знание величины потерь и их контроль в канале связи. 
Если для оптоволоконных систем такой подход может оказаться достаточным, то для открытого пространства он неприемлем, посколько априорно потери в канале связи неизвестны и могут меняться в течение передачи ключей. По-видимому, при неоднофотонном источнике и больших априорно не известных потерях, одних только фундаментальных запретов квантовой механики недостаточно для формулировки протоколов, гарантирующих секретность ключей.

Возникает принципиальный и практически важный вопрос о том, существуют ли протоколы квантового распределения ключей, которые обеспечивают безусловную секретность ключей при не строго 
однофотонном источнике и произвольных потерях в квантовом канале связи. Ниже будет предъявлен такой протокол. Данный протокол, кроме ограничений квантовой механики на различимость квантовых состояний, использует дополнительные ограничения, диктуемые специальной теорией относительности.
\end{comment}
\clearpage